{"version":3,"sources":["../../../../../../../libs/shared/data-access/src/lib/chains/chain.model.ts"],"sourcesContent":["import S from 'fluent-json-schema'\nimport { Page, PageSearchQuery, sClientEntity, sPageSearchQuery } from '../core'\nimport { ClientEntity } from '../core'\nimport {\n  sWeb3ProviderConnection,\n  Web3ProviderConnection,\n} from '../web3-client/web3-client.model'\nimport { CHAINS_ROUTES_KEY } from './chain.const'\n\n/**\n * Client Chain interface\n */\nexport interface Chain extends ChainData, ClientEntity {}\n\nexport function sChain(isPartial?: boolean) {\n  return S.object()\n    .id('#chain')\n    .additionalProperties(false)\n    .extend(sClientEntity(isPartial))\n    .extend(sChainData(isPartial))\n}\n\nexport interface ChainData {\n  name: string\n  // The HEX chain ID\n  hex: string\n  blocksPerYear: number\n  blocksMaxRange?: number\n  tokenSymbol?: string\n  color?: string\n\n  // External chain IDentifier\n  chainID: number\n  RPCs?: ChainRpc[]\n  isDisabled?: boolean\n}\n\nexport function sChainData(isPartial?: boolean) {\n  return S.object()\n    .additionalProperties(false)\n    .prop('name', S.string())\n    .description('The official name of the blockchain.')\n    .prop('hex', S.string())\n    .description('The HEX code of the blockchain.')\n    .prop('blocksPerYear', S.number())\n    .description('Number of blocks mined every year.')\n    .prop('blocksMaxRange', S.number())\n    .description('Number of max blocks to be synced.')\n    .prop('tokenSymbol', S.string())\n    .description('The token gas symbol associated to the chain e.g. ETH, ARB')\n    .prop('chainID', S.number())\n    .description('The official IDentifier of the blockchain.')\n    .prop('RPCs', S.array().items(sChainRpc()).minItems(1))\n    .description('List of the RPCs that provide the blockchain.')\n    .prop('color', S.string())\n    .description('The color of the chain')\n    .prop('isDisabled', S.boolean())\n    .description('The flag to disable the chain.')\n    .required(isPartial ? [] : ['name', 'hex', 'blocksPerYear', 'chainID'])\n}\n\nexport interface ChainRpc extends Web3ProviderConnection {\n  name: string\n  isPublic?: boolean\n}\n\nexport function sChainRpc() {\n  return S.object()\n    .additionalProperties(false)\n    .prop('name', S.string())\n    .description('The RPC official name.')\n    .required()\n    .prop('isPublic', S.boolean())\n    .description('The visibility flag.')\n    .extend(sWeb3ProviderConnection())\n}\n\nexport enum ChainErrorCodes {\n  notFound = 'CHAIN_NOT_FOUND',\n  notDeletable = 'CHAIN_NOT_DELETABLE',\n}\n\nexport type ChainFields =\n  | '_id'\n  | 'name'\n  | 'hex'\n  | 'RPCs'\n  | 'chainID'\n  | 'createdAt'\n  | 'createdBy'\n  | 'updatedAt'\n  | 'updatedBy'\n\nexport const CHAIN_FIELDS = [\n  '_id',\n  'name',\n  'hex',\n  'RPCs',\n  'chainID',\n  'createdAt',\n  'createdBy',\n  'updatedAt',\n  'updatedBy',\n]\n\nexport const CHAIN_SORT_FIELDS = ['_id', 'name']\n\nexport interface ChainsSearchQuery\n  extends PageSearchQuery<'name', ChainFields> {\n  name?: string\n  'name:ct'?: string\n  hex?: string\n  RPCs?: boolean\n  chainID?: number\n}\n\nexport function sChainsSearchQuery() {\n  return S.object()\n    .additionalProperties(false)\n    .prop('name', S.string())\n    .description('Name of the chain that must match.')\n    .prop('name:ct', S.string())\n    .description('Name of the chain that must be contained.')\n    .prop('hex', S.string())\n    .description('HEX of the chain that must match.')\n    .prop('chainID', S.number())\n    .description('The official IDentifier of the chain that must match.')\n    .extend(sPageSearchQuery(CHAIN_FIELDS, CHAIN_SORT_FIELDS))\n}\n\nexport interface ChainsClient {\n  search: (params?: ChainsSearchQuery) => Promise<Page<Chain>>\n  list: (params?: ChainsSearchQuery) => Promise<Chain[]>\n  findOne: (params?: ChainsSearchQuery) => Promise<Chain | undefined>\n  readOne: (params: ChainsSearchQuery) => Promise<Chain | undefined>\n}\n\nexport enum ChainRoutes {\n  v1Create = `v1/${CHAINS_ROUTES_KEY}`,\n  v1Delete = `v1/${CHAINS_ROUTES_KEY}/:chainId`,\n  v1Read = `v1/${CHAINS_ROUTES_KEY}/:chainId`,\n  v1Update = `v1/${CHAINS_ROUTES_KEY}/:chainId`,\n  v1Search = `v1/${CHAINS_ROUTES_KEY}`,\n}\n"],"names":["S","sClientEntity","sPageSearchQuery","sWeb3ProviderConnection","CHAINS_ROUTES_KEY","sChain","isPartial","object","id","additionalProperties","extend","sChainData","prop","string","description","number","array","items","sChainRpc","minItems","boolean","required","ChainErrorCodes","CHAIN_FIELDS","CHAIN_SORT_FIELDS","sChainsSearchQuery","ChainRoutes"],"mappings":"AAAA,OAAOA,OAAO,qBAAoB;AAClC,SAAgCC,aAAa,EAAEC,gBAAgB,QAAQ,UAAS;AAEhF,SACEC,uBAAuB,QAElB,mCAAkC;AACzC,SAASC,iBAAiB,QAAQ,gBAAe;AAOjD,OAAO,SAASC,OAAOC,SAAmB;IACxC,OAAON,EAAEO,MAAM,GACZC,EAAE,CAAC,UACHC,oBAAoB,CAAC,OACrBC,MAAM,CAACT,cAAcK,YACrBI,MAAM,CAACC,WAAWL;AACvB;AAiBA,OAAO,SAASK,WAAWL,SAAmB;IAC5C,OAAON,EAAEO,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,QAAQZ,EAAEa,MAAM,IACrBC,WAAW,CAAC,wCACZF,IAAI,CAAC,OAAOZ,EAAEa,MAAM,IACpBC,WAAW,CAAC,mCACZF,IAAI,CAAC,iBAAiBZ,EAAEe,MAAM,IAC9BD,WAAW,CAAC,sCACZF,IAAI,CAAC,kBAAkBZ,EAAEe,MAAM,IAC/BD,WAAW,CAAC,sCACZF,IAAI,CAAC,eAAeZ,EAAEa,MAAM,IAC5BC,WAAW,CAAC,8DACZF,IAAI,CAAC,WAAWZ,EAAEe,MAAM,IACxBD,WAAW,CAAC,8CACZF,IAAI,CAAC,QAAQZ,EAAEgB,KAAK,GAAGC,KAAK,CAACC,aAAaC,QAAQ,CAAC,IACnDL,WAAW,CAAC,iDACZF,IAAI,CAAC,SAASZ,EAAEa,MAAM,IACtBC,WAAW,CAAC,0BACZF,IAAI,CAAC,cAAcZ,EAAEoB,OAAO,IAC5BN,WAAW,CAAC,kCACZO,QAAQ,CAACf,YAAY,EAAE,GAAG;QAAC;QAAQ;QAAO;QAAiB;KAAU;AAC1E;AAOA,OAAO,SAASY;IACd,OAAOlB,EAAEO,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,QAAQZ,EAAEa,MAAM,IACrBC,WAAW,CAAC,0BACZO,QAAQ,GACRT,IAAI,CAAC,YAAYZ,EAAEoB,OAAO,IAC1BN,WAAW,CAAC,wBACZJ,MAAM,CAACP;AACZ;;UAEYmB;;;GAAAA,oBAAAA;AAgBZ,OAAO,MAAMC,eAAe;IAC1B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD,CAAA;AAED,OAAO,MAAMC,oBAAoB;IAAC;IAAO;CAAO,CAAA;AAWhD,OAAO,SAASC;IACd,OAAOzB,EAAEO,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,QAAQZ,EAAEa,MAAM,IACrBC,WAAW,CAAC,sCACZF,IAAI,CAAC,WAAWZ,EAAEa,MAAM,IACxBC,WAAW,CAAC,6CACZF,IAAI,CAAC,OAAOZ,EAAEa,MAAM,IACpBC,WAAW,CAAC,qCACZF,IAAI,CAAC,WAAWZ,EAAEe,MAAM,IACxBD,WAAW,CAAC,yDACZJ,MAAM,CAACR,iBAAiBqB,cAAcC;AAC3C;;UASYE;0CACC,CAAC,GAAG,EAAEtB,kBAAkB,CAAC;0CACzB,CAAC,GAAG,EAAEA,kBAAkB,SAAS,CAAC;wCACpC,CAAC,GAAG,EAAEA,kBAAkB,SAAS,CAAC;0CAChC,CAAC,GAAG,EAAEA,kBAAkB,SAAS,CAAC;0CAClC,CAAC,GAAG,EAAEA,kBAAkB,CAAC;GAL1BsB,gBAAAA"}