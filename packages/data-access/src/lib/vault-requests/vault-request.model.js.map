{"version":3,"sources":["../../../../../../../libs/shared/data-access/src/lib/vault-requests/vault-request.model.ts"],"sourcesContent":["import S from 'fluent-json-schema'\n\nimport {\n  Block,\n  iBigInt,\n  Page,\n  PageSearchQuery,\n  sBCAddress,\n  sBigInt,\n  sBlock,\n  sDateString,\n  sPageSearchQuery,\n  sStringId,\n} from '../core'\nimport { VAULT_REQUESTS_ROUTES_KEY } from './vault-request.const'\n\nexport type VaultRequestType = 'DEPOSIT' | 'WITHDRAW' | 'REDEEM' | 'WRITEOFF'\n\nexport function sVaultRequestType() {\n  return S.string().enum(['DEPOSIT', 'WITHDRAW', 'REDEEM', 'WRITEOFF'])\n}\n\nexport interface VaultRequest {\n  vaultId: string\n  vaultAddress: string\n  type: VaultRequestType\n  amount: iBigInt\n  lpAmount?: iBigInt\n  block: Block\n  isInstant?: boolean\n  requestedOn: string\n  completedOn?: string\n  walletId: string\n  walletAddress: string\n  status: VaultRequestStatus\n  epochNumber?: number\n}\n\nexport type VaultRequestStatus =\n  | 'PENDING'\n  | 'PROCESSED'\n  | 'CLAIMABLE'\n  | 'INSTANT_CLAIMABLE'\n  | 'CLAIMED'\n  | 'FULFILLED'\n  | 'COMPLETED'\n\nexport function sVaultRequestStatus() {\n  return S.string().enum([\n    'PENDING',\n    'PROCESSED',\n    'CLAIMABLE',\n    'INSTANT_CLAIMABLE',\n    'CLAIMED',\n    'FULFILLED',\n    'COMPLETED',\n  ])\n}\n\nexport function sVaultRequest(isPartial?: boolean) {\n  return S.object()\n    .additionalProperties(false)\n    .prop('vaultId', sStringId())\n    .prop('vaultAddress', sBCAddress())\n    .prop('block', sBlock())\n    .prop('type', sVaultRequestType())\n    .prop('amount', sBigInt())\n    .prop('lpAmount', sBigInt())\n    .prop('requestedOn', sDateString())\n    .prop('completedOn', sDateString())\n    .prop('walletId', sStringId())\n    .prop('walletAddress', sBCAddress())\n    .prop('status', sVaultRequestStatus())\n    .prop('epochNumber', S.number())\n    .prop('isInstant', S.boolean())\n    .required(\n      isPartial\n        ? []\n        : [\n            'vaultId',\n            'vaultAddress',\n            'block',\n            'type',\n            'amount',\n            'requestedOn',\n            'walletId',\n            'walletAddress',\n            'status',\n          ]\n    )\n}\n\nexport type VaultRequestField =\n  | '_id'\n  | 'vaultId'\n  | 'vaultAddress'\n  | 'walletId'\n  | 'walletAddress'\n  | 'requestedOn'\n  | 'status'\n  | 'type'\n  | 'amount'\n  | 'lpAmount'\n  | 'block'\n  | 'epochNumber'\n  | 'isInstant'\n\nexport const VAULT_REQUEST_FIELDS: VaultRequestField[] = [\n  '_id',\n  'vaultId',\n  'vaultAddress',\n  'walletId',\n  'walletAddress',\n  'requestedOn',\n  'status',\n  'type',\n  'amount',\n  'lpAmount',\n  'block',\n  'epochNumber',\n  'isInstant',\n]\n\nexport const VAULT_REQUEST_SORT_FIELDS = ['requestedOn', 'block.number']\nexport type VaultRequestsSortField = 'requestedOn' | 'block.number'\n\nexport interface VaultRequestsSearchQuery\n  extends PageSearchQuery<VaultRequestsSortField, VaultRequestField> {\n  vaultId?: string | string[]\n  vaultAddress?: string | string[]\n  walletAddress?: string | string[]\n  walletId?: string | string[]\n  status?: VaultRequestStatus | VaultRequestStatus[]\n  type?: VaultRequestType | VaultRequestType[]\n}\n\nexport enum VaultRequestErrorCodes {\n  notMatching = 'VAULT_REQUEST_NOT_MATCHING',\n  notClaimable = 'VAULT_REQUEST_NOT_CLAIMABLE',\n  epochNumber = 'VAULT_REQUEST_INVALID_EPOCH_NUMBER',\n  wrongStatus = 'VAULT_REQUEST_WRONG_STATUS',\n  wrongType = 'VAULT_REQUEST_WRONG_TYPE',\n  transactionNotFound = 'VAULT_REQUEST_TRANSACTION_NOT_FOUND',\n  writeOffAmounts = 'VAULT_REQUEST_WRITEOFF_AMOUNTS',\n}\n\nexport function sVaultRequestsSearchQuery() {\n  return S.object()\n    .prop('vaultId', S.array().items(sStringId()).minItems(1).maxItems(200))\n    .prop(\n      'vaultAddress',\n      S.array().items(sBCAddress()).minItems(1).maxItems(200)\n    )\n    .prop(\n      'walletAddress',\n      S.array().items(sBCAddress()).minItems(1).maxItems(200)\n    )\n    .prop('walletId', S.array().items(sStringId()).minItems(1).maxItems(200))\n    .prop('status', S.array().items(sVaultRequestStatus()))\n    .prop('type', S.array().items(sVaultRequestType()))\n    .extend(sPageSearchQuery(VAULT_REQUEST_FIELDS, VAULT_REQUEST_SORT_FIELDS))\n}\n\nexport interface VaultRequestsClientModel {\n  search: (params?: VaultRequestsSearchQuery) => Promise<Page<VaultRequest>>\n  searchAll: (params?: VaultRequestsSearchQuery) => Promise<Page<VaultRequest>>\n  list: (params?: VaultRequestsSearchQuery) => Promise<VaultRequest[]>\n  listAll: (params?: VaultRequestsSearchQuery) => Promise<VaultRequest[]>\n  findOne: (\n    params?: VaultRequestsSearchQuery\n  ) => Promise<VaultRequest | undefined>\n  readOne: (params: VaultRequestsSearchQuery) => Promise<VaultRequest>\n}\n\nexport enum VaultRequestsRoutes {\n  v1Search = `v1/${VAULT_REQUESTS_ROUTES_KEY}`,\n}\n"],"names":["VAULT_REQUEST_FIELDS","VAULT_REQUEST_SORT_FIELDS","sVaultRequest","sVaultRequestStatus","sVaultRequestType","sVaultRequestsSearchQuery","S","string","enum","isPartial","object","additionalProperties","prop","sStringId","sBCAddress","sBlock","sBigInt","sDateString","number","boolean","required","VaultRequestErrorCodes","array","items","minItems","maxItems","extend","sPageSearchQuery","VaultRequestsRoutes","VAULT_REQUESTS_ROUTES_KEY"],"mappings":";;;;;;;;;;;IA2GaA,oBAAoB;eAApBA;;IAgBAC,yBAAyB;eAAzBA;;;;;;;;IAhEGC,aAAa;eAAbA;;IAZAC,mBAAmB;eAAnBA;;IA7BAC,iBAAiB;eAAjBA;;IAgIAC,yBAAyB;eAAzBA;;;;2EAlJF;sBAaP;mCACmC;AAInC,SAASD;IACd,OAAOE,yBAAC,CAACC,MAAM,GAAGC,IAAI,CAAC;QAAC;QAAW;QAAY;QAAU;KAAW;AACtE;AA2BO,SAASL;IACd,OAAOG,yBAAC,CAACC,MAAM,GAAGC,IAAI,CAAC;QACrB;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AACH;AAEO,SAASN,cAAcO,SAAmB;IAC/C,OAAOH,yBAAC,CAACI,MAAM,GACZC,oBAAoB,CAAC,OACrBC,IAAI,CAAC,WAAWC,IAAAA,eAAS,KACzBD,IAAI,CAAC,gBAAgBE,IAAAA,gBAAU,KAC/BF,IAAI,CAAC,SAASG,IAAAA,YAAM,KACpBH,IAAI,CAAC,QAAQR,qBACbQ,IAAI,CAAC,UAAUI,IAAAA,aAAO,KACtBJ,IAAI,CAAC,YAAYI,IAAAA,aAAO,KACxBJ,IAAI,CAAC,eAAeK,IAAAA,iBAAW,KAC/BL,IAAI,CAAC,eAAeK,IAAAA,iBAAW,KAC/BL,IAAI,CAAC,YAAYC,IAAAA,eAAS,KAC1BD,IAAI,CAAC,iBAAiBE,IAAAA,gBAAU,KAChCF,IAAI,CAAC,UAAUT,uBACfS,IAAI,CAAC,eAAeN,yBAAC,CAACY,MAAM,IAC5BN,IAAI,CAAC,aAAaN,yBAAC,CAACa,OAAO,IAC3BC,QAAQ,CACPX,YACI,EAAE,GACF;QACE;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AAEX;AAiBO,MAAMT,uBAA4C;IACvD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,MAAMC,4BAA4B;IAAC;IAAe;CAAe;;UAa5DoB;;;;;;;;GAAAA,2BAAAA;AAUL,SAAShB;IACd,OAAOC,yBAAC,CAACI,MAAM,GACZE,IAAI,CAAC,WAAWN,yBAAC,CAACgB,KAAK,GAAGC,KAAK,CAACV,IAAAA,eAAS,KAAIW,QAAQ,CAAC,GAAGC,QAAQ,CAAC,MAClEb,IAAI,CACH,gBACAN,yBAAC,CAACgB,KAAK,GAAGC,KAAK,CAACT,IAAAA,gBAAU,KAAIU,QAAQ,CAAC,GAAGC,QAAQ,CAAC,MAEpDb,IAAI,CACH,iBACAN,yBAAC,CAACgB,KAAK,GAAGC,KAAK,CAACT,IAAAA,gBAAU,KAAIU,QAAQ,CAAC,GAAGC,QAAQ,CAAC,MAEpDb,IAAI,CAAC,YAAYN,yBAAC,CAACgB,KAAK,GAAGC,KAAK,CAACV,IAAAA,eAAS,KAAIW,QAAQ,CAAC,GAAGC,QAAQ,CAAC,MACnEb,IAAI,CAAC,UAAUN,yBAAC,CAACgB,KAAK,GAAGC,KAAK,CAACpB,wBAC/BS,IAAI,CAAC,QAAQN,yBAAC,CAACgB,KAAK,GAAGC,KAAK,CAACnB,sBAC7BsB,MAAM,CAACC,IAAAA,sBAAgB,EAAC3B,sBAAsBC;AACnD;;UAaY2B;0DACC,CAAC,GAAG,EAAEC,4CAAyB,CAAC,CAAC;GADlCD,wBAAAA"}