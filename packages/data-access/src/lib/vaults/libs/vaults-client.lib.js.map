{"version":3,"sources":["../../../../../../../../libs/shared/data-access/src/lib/vaults/libs/vaults-client.lib.ts"],"sourcesContent":["import { Axios } from 'axios'\nimport {\n  Vault,\n  VaultData,\n  VaultRoutes,\n  VaultTransferBody,\n  VaultPerformBody,\n  VaultsClientModel,\n  VaultsSearchQuery,\n  VaultSyncBody,\n  VaultBlockEventBody,\n  VaultPositionQuery,\n  VaultIntegrationsQuery,\n  VaultSyncBlockBody,\n  VaultsPerformancesQuery,\n  VaultsPerformances,\n  VaultIntegrationsData,\n} from '../vault.model'\nimport { WalletPosition } from '../../wallet-performances'\nimport { ApiEntity, Block, uriFy } from '../../core'\nimport { stringify } from '../../core/utility.lib'\n\nexport class VaultsClient extends ApiEntity implements VaultsClientModel {\n  constructor(axios: Axios) {\n    super(axios)\n  }\n\n  /**\n   * Create a vault\n   * @param body - the vault data\n   * @returns the created vault\n   */\n  public create(body: VaultData) {\n    return this._create<Vault>(VaultRoutes.v1Create, body)\n  }\n\n  /**\n   * Search vaults by params\n   * @param searchParams - the filters to apply\n   * @returns a vaults page\n   */\n  public search(searchParams?: VaultsSearchQuery) {\n    return this._search<Vault>(VaultRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * List vaults by params\n   * @param searchParams - the filters to apply\n   * @returns the vault list\n   */\n  public list(searchParams?: VaultsSearchQuery) {\n    return this._list<Vault>(VaultRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * Find a vault by params\n   * @param searchParams - the filters to apply\n   * @returns an optional vault\n   */\n  public findOne(searchParams: VaultsSearchQuery) {\n    return this._findOne<Vault>(VaultRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * Read a vault by params\n   * @param searchParams - the filters to apply\n   * @returns the vault\n   */\n  public readOne(searchParams: VaultsSearchQuery) {\n    return this._readOne<Vault>(VaultRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * Get wallet position for a vault\n   * @param vaultId - the vault id\n   * @param searchParams - the position filters\n   * @returns the wallet position\n   */\n  public position(vaultId: string, searchParams: VaultPositionQuery) {\n    return this.axios\n      .request<WalletPosition>({\n        url: VaultRoutes.v1Position.replace(':vaultId', vaultId),\n        method: 'GET',\n        params: new URLSearchParams(uriFy(searchParams)),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Get performances breakdown\n   * @param params - the performances filters\n   * @returns the performances summary\n   */\n  public performances(params: VaultsPerformancesQuery) {\n    return this.axios\n      .request<VaultsPerformances>({\n        url: VaultRoutes.v1Performances,\n        method: 'GET',\n        params: new URLSearchParams(uriFy(params)),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Get integrations data\n   * @param vaultId - the vault id\n   * @param searchParams - the integrations filters\n   * @returns the integrations data\n   */\n  public integrations(vaultId: string, searchParams: VaultIntegrationsQuery) {\n    return this.axios\n      .request<VaultIntegrationsData>({\n        url: VaultRoutes.v1Integrations.replace(':vaultId', vaultId),\n        method: 'GET',\n        params: new URLSearchParams(uriFy(searchParams)),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Sync vault state\n   * @param vaultId - the vault id\n   * @param body - the sync payload\n   * @returns the synced block number\n   */\n  public sync(vaultId: string, body: VaultSyncBody) {\n    return this.axios\n      .request<number>({\n        url: VaultRoutes.v1Sync.replace(':vaultId', vaultId),\n        method: 'POST',\n        data: stringify(body),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Sync a specific block\n   * @param vaultId - the vault id\n   * @param body - the sync payload\n   * @returns whether the sync happened\n   */\n  public syncBlock(vaultId: string, body: VaultSyncBlockBody) {\n    return this.axios\n      .request<boolean>({\n        url: VaultRoutes.v1SyncBlock.replace(':vaultId', vaultId),\n        method: 'POST',\n        data: stringify(body),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Emit a block event\n   * @param vaultId - the vault id\n   * @param body - the event payload\n   * @returns void\n   */\n  public block(vaultId: string, body: VaultBlockEventBody) {\n    return this.axios\n      .request<void>({\n        url: VaultRoutes.v1Block.replace(':vaultId', vaultId),\n        method: 'POST',\n        data: stringify(body),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Perform a vault action\n   * @param vaultId - the vault id\n   * @param body - the perform payload\n   * @returns void\n   */\n  public perform(vaultId: string, body: VaultPerformBody) {\n    return this.axios\n      .request<void>({\n        url: VaultRoutes.v1Perform.replace(':vaultId', vaultId),\n        method: 'POST',\n        data: stringify(body),\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Cure a vault\n   * @param vaultId - the vault id\n   * @returns void\n   */\n  public cure(vaultId: string) {\n    return this.axios\n      .request<void>({\n        url: VaultRoutes.v1Cure.replace(':vaultId', vaultId),\n        method: 'POST',\n      })\n      .then((response) => response.data)\n  }\n}\n"],"names":["VaultsClient","ApiEntity","create","body","_create","VaultRoutes","v1Create","search","searchParams","_search","v1Search","list","_list","findOne","_findOne","readOne","_readOne","position","vaultId","axios","request","url","v1Position","replace","method","params","URLSearchParams","uriFy","then","response","data","performances","v1Performances","integrations","v1Integrations","sync","v1Sync","stringify","syncBlock","v1SyncBlock","block","v1Block","perform","v1Perform","cure","v1Cure","constructor"],"mappings":"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"}