{"version":3,"sources":["../../../../../../../../libs/shared/data-access/src/lib/integrations/lido-client/lido-client.ts"],"sourcesContent":["import { BNify } from '../../core'\nimport { IntegrationClientModel } from '../integration-client.model'\nimport axios, { Axios, CreateAxiosDefaults } from 'axios'\n\nexport class LidoClient implements IntegrationClientModel {\n  // Axios instance\n  private axios: Axios\n\n  constructor() {\n    this.axios = this.initAxios()\n  }\n\n  /**\n   * Axios initialization\n   */\n  private initAxios() {\n    const options: CreateAxiosDefaults = {\n      headers: {\n        'content-type': 'application/json',\n      },\n    }\n    return axios.create(options)\n  }\n\n  // Methods\n\n  public async getApr(tokenSymbol: string): Promise<number> {\n    switch (tokenSymbol) {\n      case 'stETH':\n        return this.getStETHApr()\n      case 'MATIC':\n        return this.getMaticApr()\n      default:\n        return 0\n    }\n  }\n\n  public async getStETHApr(): Promise<number> {\n    return this.axios\n      .get('https://eth-api.lido.fi/v1/protocol/steth/apr/last', {\n        responseType: 'json',\n      })\n      .then((response) => {\n        if (!response?.data) {\n          return 0\n        }\n\n        const {\n          data: { apr },\n        } = response.data\n\n        return BNify(apr).toNumber()\n      })\n      .catch(() => 0)\n  }\n\n  public async getMaticApr(): Promise<number> {\n    return this.axios\n      .get('https://polygon.lido.fi/api/stats', { responseType: 'json' })\n      .then((response) => BNify(response?.data).toNumber())\n      .catch(() => 0)\n  }\n}\n"],"names":["LidoClient","initAxios","options","headers","axios","create","getApr","tokenSymbol","getStETHApr","getMaticApr","get","responseType","then","response","data","apr","BNify","toNumber","catch","constructor"],"mappings":";;;;+BAIaA;;;eAAAA;;;;sBAJS;gEAE4B;AAE3C,IAAA,AAAMA,aAAN,MAAMA;IAQX;;GAEC,GACD,AAAQC,YAAY;QAClB,MAAMC,UAA+B;YACnCC,SAAS;gBACP,gBAAgB;YAClB;QACF;QACA,OAAOC,cAAK,CAACC,MAAM,CAACH;IACtB;IAEA,UAAU;IAEV,MAAaI,OAAOC,WAAmB,EAAmB;QACxD,OAAQA;YACN,KAAK;gBACH,OAAO,IAAI,CAACC,WAAW;YACzB,KAAK;gBACH,OAAO,IAAI,CAACC,WAAW;YACzB;gBACE,OAAO;QACX;IACF;IAEA,MAAaD,cAA+B;QAC1C,OAAO,IAAI,CAACJ,KAAK,CACdM,GAAG,CAAC,sDAAsD;YACzDC,cAAc;QAChB,GACCC,IAAI,CAAC,CAACC;YACL,IAAI,EAACA,4BAAAA,SAAUC,IAAI,GAAE;gBACnB,OAAO;YACT;YAEA,MAAM,EACJA,MAAM,EAAEC,GAAG,EAAE,EACd,GAAGF,SAASC,IAAI;YAEjB,OAAOE,IAAAA,WAAK,EAACD,KAAKE,QAAQ;QAC5B,GACCC,KAAK,CAAC,IAAM;IACjB;IAEA,MAAaT,cAA+B;QAC1C,OAAO,IAAI,CAACL,KAAK,CACdM,GAAG,CAAC,qCAAqC;YAAEC,cAAc;QAAO,GAChEC,IAAI,CAAC,CAACC,WAAaG,IAAAA,WAAK,EAACH,4BAAAA,SAAUC,IAAI,EAAEG,QAAQ,IACjDC,KAAK,CAAC,IAAM;IACjB;IArDAC,aAAc;QACZ,IAAI,CAACf,KAAK,GAAG,IAAI,CAACH,SAAS;IAC7B;AAoDF"}