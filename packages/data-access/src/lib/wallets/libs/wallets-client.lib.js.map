{"version":3,"sources":["../../../../../../../../libs/shared/data-access/src/lib/wallets/libs/wallets-client.lib.ts"],"sourcesContent":["import { Axios } from 'axios'\nimport {\n  Wallet,\n  WalletAccess,\n  WalletPortfolioQuery,\n  WalletRoutes,\n  WalletUserBody,\n  WalletsClientModel,\n  WalletsSearchQuery,\n  WalletVaultHistoryQuery,\n} from '../wallet.model'\nimport {\n  WalletPortfolio,\n  WalletPosition,\n  WalletVaultHistory,\n} from '../../wallet-performances'\nimport { User } from '../../users'\nimport { ApiEntity, Page, replaceMany, uriFy } from '../../core'\n\nexport class WalletsClient extends ApiEntity implements WalletsClientModel {\n  constructor(axios: Axios) {\n    super(axios)\n  }\n\n  /**\n   * Search wallets by params\n   * @param searchParams - the filters to apply\n   * @returns a wallets page\n   */\n  public search(searchParams?: WalletsSearchQuery) {\n    return this._search<Wallet>(WalletRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * List wallets by params\n   * @param searchParams - the filters to apply\n   * @returns the wallets list\n   */\n  public list(searchParams?: WalletsSearchQuery) {\n    return this._list<Wallet>(WalletRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * Find a wallet by params\n   * @param searchParams - the filters to apply\n   * @returns an optional wallet\n   */\n  public findOne(searchParams?: WalletsSearchQuery) {\n    return this._findOne<Wallet>(WalletRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * Read a wallet by params\n   * @param searchParams - the filters to apply\n   * @returns the wallet\n   */\n  public readOne(searchParams: WalletsSearchQuery) {\n    return this._readOne<Wallet>(WalletRoutes.v1Search, searchParams)\n  }\n\n  /**\n   * Get wallet portfolio data\n   * @param walletId - the wallet id\n   * @param params - the portfolio filters\n   * @returns the wallet portfolio\n   */\n  public portfolio(walletId: string, params?: WalletPortfolioQuery) {\n    return this.axios\n      .request<WalletPortfolio>({\n        url: WalletRoutes.v1Portfolio.replace(':walletId', walletId),\n        method: 'GET',\n        params: params ? new URLSearchParams(uriFy(params)) : undefined,\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Get wallet vault positions\n   * @param walletId - the wallet id\n   * @param searchParams - the portfolio filters\n   * @returns the wallet positions\n   */\n  public vaults(walletId: string, searchParams?: WalletPortfolioQuery) {\n    return this.axios\n      .request<WalletPosition[]>({\n        url: replaceMany(WalletRoutes.v1Vaults, {\n          ':walletId': walletId,\n        }),\n        method: 'GET',\n        params: searchParams\n          ? new URLSearchParams(uriFy(searchParams))\n          : undefined,\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Get wallet vault history\n   * @param walletId - the wallet id\n   * @param searchParams - the portfolio filters\n   * @returns the wallet positions\n   */\n  public vault(\n    walletId: string,\n    vaultId: string,\n    params?: WalletVaultHistoryQuery\n  ) {\n    return this.axios\n      .request<Page<WalletVaultHistory>>({\n        url: replaceMany(WalletRoutes.v1History, {\n          ':walletId': walletId,\n          ':vaultId': vaultId,\n        }),\n        method: 'GET',\n        params: params ? new URLSearchParams(uriFy(params)) : undefined,\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Ensure wallet existence by address\n   * @param address - the wallet address\n   * @returns the ensured wallet\n   */\n  public ensure(address: string) {\n    return this.axios\n      .request<Wallet>({\n        url: WalletRoutes.v1Ensure,\n        method: 'POST',\n        data: { address },\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Attach a user profile to a wallet\n   * @param walletId - the wallet id\n   * @param body - the user payload\n   * @returns the updated user\n   */\n  public user(walletId: string, body: WalletUserBody) {\n    return this.axios\n      .request<User>({\n        url: WalletRoutes.v1User.replace(':walletId', walletId),\n        method: 'POST',\n        data: body,\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Register a referral for a wallet\n   * @param walletId - the wallet id\n   * @param referral - the referral code\n   * @returns the updated wallet\n   */\n  public referral(walletId: string, referral: string) {\n    return this.axios\n      .request<Wallet>({\n        url: WalletRoutes.v1Referral.replace(':walletId', walletId),\n        method: 'POST',\n        data: { referral },\n      })\n      .then((response) => response.data)\n  }\n\n  /**\n   * Read wallet access policies\n   * @param walletId - the wallet id\n   * @returns the wallet access object\n   */\n  public access(walletId: string) {\n    return this.axios\n      .request<WalletAccess>({\n        url: WalletRoutes.v1Access.replace(':walletId', walletId),\n        method: 'GET',\n      })\n      .then((response) => response.data)\n  }\n}\n"],"names":["WalletsClient","ApiEntity","search","searchParams","_search","WalletRoutes","v1Search","list","_list","findOne","_findOne","readOne","_readOne","portfolio","walletId","params","axios","request","url","v1Portfolio","replace","method","URLSearchParams","uriFy","undefined","then","response","data","vaults","replaceMany","v1Vaults","vault","vaultId","v1History","ensure","address","v1Ensure","user","body","v1User","referral","v1Referral","access","v1Access","constructor"],"mappings":"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"}