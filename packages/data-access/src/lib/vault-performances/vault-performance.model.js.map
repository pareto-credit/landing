{"version":3,"sources":["../../../../../../../libs/shared/data-access/src/lib/vault-performances/vault-performance.model.ts"],"sourcesContent":["import S from 'fluent-json-schema'\nimport {\n  sBigInt,\n  sBlock,\n  sClientEntity,\n  sPageSearchQuery,\n  sReward,\n  sStringId,\n} from '../core'\nimport { Block, ClientEntity, PageSearchQuery, Reward, iBigInt } from '../core'\nimport { VAULT_PERFORMANCES_ROUTES_KEY } from './vault-performance.const'\n\n/**\n * Client VaultPerformance interface\n */\nexport interface VaultPerformance extends VaultPerformanceData, ClientEntity {}\n\nexport function sVaultPerformance(isPartial?: boolean) {\n  return S.object()\n    .id('#vaultPerformance')\n    .additionalProperties(false)\n    .extend(sClientEntity(isPartial))\n    .extend(sVaultPerformanceData(isPartial))\n}\n\nexport interface VaultPerformanceData extends VaultBlockPerformance {\n  vaultId: string\n  vaultBlockId: string\n  block: Block\n}\n\nexport function sVaultPerformanceData(isPartial?: boolean) {\n  return S.object()\n    .additionalProperties(false)\n    .prop('vaultId', sStringId())\n    .prop('vaultBlockId', sStringId())\n    .prop('block', sBlock())\n    .required(isPartial ? [] : ['vaultId', 'vaultBlockId', 'block'])\n    .extend(sVaultBlockPerformance(isPartial))\n}\n\nexport interface VaultBlockPerformance {\n  // The age of the block performance in seconds\n  age: number\n  // The number of the HODLers\n  holders: number\n  // APY realized\n  realizedAPY: number\n  // The earnings datas\n  earnings: VaultBlockEarnings\n  // The rewards data\n  accruedRewards?: Reward[]\n}\n\nexport function sVaultBlockPerformance(isPartial?: boolean) {\n  return S.object()\n    .additionalProperties(false)\n    .prop('age', S.number())\n    .description('The age of the block performance in seconds.')\n    .prop('holders', S.number())\n    .description(\"The vault's holders number.\")\n    .prop('realizedAPY', S.number())\n    .description(\"The vault's realized APY.\")\n    .prop('accruedRewards', S.array().items(sReward()))\n    .description('The accrued rewards of the vault.')\n    .prop('earnings', sVaultBlockPerformanceEarnings())\n    .description(\"The vault's earnings.\")\n    .required(\n      isPartial\n        ? []\n        : ['age', 'holders', 'realizedAPY', 'accruedRewards', 'earnings']\n    )\n}\n\nexport interface VaultBlockEarnings {\n  // USD amount\n  USD: iBigInt\n  // Token amount\n  token: iBigInt\n  // The percentage of the earning from the starting price\n  percentage: number\n}\n\nexport function sVaultBlockPerformanceEarnings() {\n  return S.object()\n    .additionalProperties(false)\n    .prop('USD', sBigInt())\n    .required()\n    .prop('token', sBigInt())\n    .required()\n    .prop('percentage', S.number())\n    .required()\n}\n\nexport enum VaultPerformanceErrorCodes {\n  alreadyExists = 'VAULT_PERFORMANCE_ALREADY_EXISTS',\n}\n\nexport type VaultPerformanceFields =\n  | '_id'\n  | 'vaultId'\n  | 'vaultBlockId'\n  | 'block'\n  | 'age'\n  | 'holders'\n  | 'realizedAPY'\n  | 'accruedRewards'\n  | 'earnings'\n  | 'createdAt'\n  | 'createdBy'\n  | 'updatedAt'\n  | 'updatedBy'\n\nexport const VAULT_PERFORMANCE_FIELDS = [\n  '_id',\n  'vaultId',\n  'vaultBlockId',\n  'block',\n  'age',\n  'holders',\n  'realizedAPY',\n  'accruedRewards',\n  'earnings',\n  'createdAt',\n  'createdBy',\n  'updatedAt',\n  'updatedBy',\n]\n\nexport const VAULT_PERFORMANCE_SORT_FIELDS = ['_id']\n\nexport interface VaultPerformancesSearchQuery\n  extends PageSearchQuery<'_id', VaultPerformanceFields> {\n  vaultId?: string | string[]\n  vaultBlockId?: string | string[]\n}\n\nexport function sVaultPerformancesSearchQuery() {\n  return S.object()\n    .additionalProperties(false)\n    .prop('vaultId', S.array().minItems(1).maxItems(200).items(sStringId()))\n    .description('Vault IDs of the performance that must match.')\n    .prop(\n      'vaultBlockId',\n      S.array().minItems(1).maxItems(200).items(sStringId())\n    )\n    .description('Vault block IDs of the performance that must match.')\n    .extend(\n      sPageSearchQuery(VAULT_PERFORMANCE_FIELDS, VAULT_PERFORMANCE_SORT_FIELDS)\n    )\n}\n\nexport enum VaultPerformanceRoutes {\n  v1Create = `v1/${VAULT_PERFORMANCES_ROUTES_KEY}`,\n  v1Delete = `v1/${VAULT_PERFORMANCES_ROUTES_KEY}/:vaultPerformanceId`,\n  v1Read = `v1/${VAULT_PERFORMANCES_ROUTES_KEY}/:vaultPerformanceId`,\n  v1Update = `v1/${VAULT_PERFORMANCES_ROUTES_KEY}/:vaultPerformanceId`,\n  v1Search = `v1/${VAULT_PERFORMANCES_ROUTES_KEY}`,\n}\n"],"names":["S","sBigInt","sBlock","sClientEntity","sPageSearchQuery","sReward","sStringId","VAULT_PERFORMANCES_ROUTES_KEY","sVaultPerformance","isPartial","object","id","additionalProperties","extend","sVaultPerformanceData","prop","required","sVaultBlockPerformance","number","description","array","items","sVaultBlockPerformanceEarnings","VaultPerformanceErrorCodes","VAULT_PERFORMANCE_FIELDS","VAULT_PERFORMANCE_SORT_FIELDS","sVaultPerformancesSearchQuery","minItems","maxItems","VaultPerformanceRoutes"],"mappings":"AAAA,OAAOA,OAAO,qBAAoB;AAClC,SACEC,OAAO,EACPC,MAAM,EACNC,aAAa,EACbC,gBAAgB,EAChBC,OAAO,EACPC,SAAS,QACJ,UAAS;AAEhB,SAASC,6BAA6B,QAAQ,4BAA2B;AAOzE,OAAO,SAASC,kBAAkBC,SAAmB;IACnD,OAAOT,EAAEU,MAAM,GACZC,EAAE,CAAC,qBACHC,oBAAoB,CAAC,OACrBC,MAAM,CAACV,cAAcM,YACrBI,MAAM,CAACC,sBAAsBL;AAClC;AAQA,OAAO,SAASK,sBAAsBL,SAAmB;IACvD,OAAOT,EAAEU,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,WAAWT,aAChBS,IAAI,CAAC,gBAAgBT,aACrBS,IAAI,CAAC,SAASb,UACdc,QAAQ,CAACP,YAAY,EAAE,GAAG;QAAC;QAAW;QAAgB;KAAQ,EAC9DI,MAAM,CAACI,uBAAuBR;AACnC;AAeA,OAAO,SAASQ,uBAAuBR,SAAmB;IACxD,OAAOT,EAAEU,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,OAAOf,EAAEkB,MAAM,IACpBC,WAAW,CAAC,gDACZJ,IAAI,CAAC,WAAWf,EAAEkB,MAAM,IACxBC,WAAW,CAAC,+BACZJ,IAAI,CAAC,eAAef,EAAEkB,MAAM,IAC5BC,WAAW,CAAC,6BACZJ,IAAI,CAAC,kBAAkBf,EAAEoB,KAAK,GAAGC,KAAK,CAAChB,YACvCc,WAAW,CAAC,qCACZJ,IAAI,CAAC,YAAYO,kCACjBH,WAAW,CAAC,yBACZH,QAAQ,CACPP,YACI,EAAE,GACF;QAAC;QAAO;QAAW;QAAe;QAAkB;KAAW;AAEzE;AAWA,OAAO,SAASa;IACd,OAAOtB,EAAEU,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,OAAOd,WACZe,QAAQ,GACRD,IAAI,CAAC,SAASd,WACde,QAAQ,GACRD,IAAI,CAAC,cAAcf,EAAEkB,MAAM,IAC3BF,QAAQ;AACb;;UAEYO;;GAAAA,+BAAAA;AAmBZ,OAAO,MAAMC,2BAA2B;IACtC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD,CAAA;AAED,OAAO,MAAMC,gCAAgC;IAAC;CAAM,CAAA;AAQpD,OAAO,SAASC;IACd,OAAO1B,EAAEU,MAAM,GACZE,oBAAoB,CAAC,OACrBG,IAAI,CAAC,WAAWf,EAAEoB,KAAK,GAAGO,QAAQ,CAAC,GAAGC,QAAQ,CAAC,KAAKP,KAAK,CAACf,cAC1Da,WAAW,CAAC,iDACZJ,IAAI,CACH,gBACAf,EAAEoB,KAAK,GAAGO,QAAQ,CAAC,GAAGC,QAAQ,CAAC,KAAKP,KAAK,CAACf,cAE3Ca,WAAW,CAAC,uDACZN,MAAM,CACLT,iBAAiBoB,0BAA0BC;AAEjD;;UAEYI;gEACC,CAAC,GAAG,EAAEtB,8BAA8B,CAAC;gEACrC,CAAC,GAAG,EAAEA,8BAA8B,oBAAoB,CAAC;8DAC3D,CAAC,GAAG,EAAEA,8BAA8B,oBAAoB,CAAC;gEACvD,CAAC,GAAG,EAAEA,8BAA8B,oBAAoB,CAAC;gEACzD,CAAC,GAAG,EAAEA,8BAA8B,CAAC;GALtCsB,2BAAAA"}